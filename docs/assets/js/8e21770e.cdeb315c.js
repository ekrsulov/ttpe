"use strict";(self.webpackChunkttpe_docs=self.webpackChunkttpe_docs||[]).push([[938],{5339:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>P,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/catalog/edit","title":"Edit Plugin","description":"Purpose: Advanced path editing with control point manipulation","source":"@site/docs/plugins/catalog/edit.md","sourceDirName":"plugins/catalog","slug":"/plugins/catalog/edit","permalink":"/ttpe/docs/docs/plugins/catalog/edit","draft":false,"unlisted":false,"editUrl":"https://github.com/ekrsulov/ttpe/tree/main/doc/docs/plugins/catalog/edit.md","tags":[],"version":"current","lastUpdatedBy":"Ernesto Krsulovic","lastUpdatedAt":1762144584000,"frontMatter":{"id":"edit","title":"Edit Plugin","sidebar_label":"Edit"},"sidebar":"docs","previous":{"title":"Transformation","permalink":"/ttpe/docs/docs/plugins/catalog/transformation"},"next":{"title":"Subpath","permalink":"/ttpe/docs/docs/plugins/catalog/subpath"}}');var a=t(4848),s=t(8453);const o={id:"edit",title:"Edit Plugin",sidebar_label:"Edit"},r="Edit Plugin",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Plugin Interaction Flow",id:"plugin-interaction-flow",level:2},{value:"Point Editing System",id:"point-editing-system",level:2},{value:"State Management",id:"state-management",level:2},{value:"Handler",id:"handler",level:2},{value:"Keyboard Shortcuts",id:"keyboard-shortcuts",level:2},{value:"UI Contributions",id:"ui-contributions",level:2},{value:"Panels",id:"panels",level:3},{value:"Overlays",id:"overlays",level:3},{value:"Canvas Layers",id:"canvas-layers",level:3},{value:"Public APIs",id:"public-apis",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Edge Cases &amp; Limitations",id:"edge-cases--limitations",level:2},{value:"Related",id:"related",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"edit-plugin",children:"Edit Plugin"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Purpose"}),": Advanced path editing with control point manipulation"]}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Select and drag points"}),"\n",(0,a.jsx)(n.li,{children:"Convert command types (line, curve, arc)"}),"\n",(0,a.jsx)(n.li,{children:"Smooth brush for path smoothing"}),"\n",(0,a.jsx)(n.li,{children:"Point simplification"}),"\n",(0,a.jsx)(n.li,{children:"Align control points"}),"\n",(0,a.jsx)(n.li,{children:"Delete points"}),"\n",(0,a.jsx)(n.li,{children:"Split subpaths"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"plugin-interaction-flow",children:"Plugin Interaction Flow"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant User\n    participant UI as UI/Toolbar\n    participant PM as PluginManager\n    participant EP as Edit Plugin\n    participant Store as Canvas Store\n    participant EB as Event Bus\n    participant Canvas as Canvas Renderer\n    participant PP as Path Parser\n    \n    Note over User,Canvas: 1. Plugin Activation\n    User->>UI: Click Edit Tool\n    UI->>Store: setMode('edit')\n    Store->>PM: Plugin mode changed\n    PM->>EP: activate()\n    EP->>Store: Initialize edit slice\n    EP->>Store: Get selected elements\n    EP->>PP: parsePathData(elements)\n    PP->>EP: Return path commands & points\n    EP->>Store: Set editable points\n    EP->>EB: Publish 'plugin:activated'\n    EB->>Canvas: Draw control points\n    EB->>Canvas: Draw bezier handles\n    \n    Note over User,Canvas: 2. Select Control Point\n    User->>Canvas: Click on control point\n    Canvas->>EP: handlePointDown(pointId, event)\n    EP->>Store: Set selectedPoints = [pointId]\n    EP->>Store: Store initial position\n    EP->>EB: Publish 'points:selected'\n    EB->>Canvas: Highlight selected point\n    EB->>UI: Show point coordinates\n    \n    Note over User,Canvas: 3. Drag Control Point\n    User->>Canvas: Drag control point\n    Canvas->>EP: handlePointMove(event)\n    EP->>Store: Get selectedPoints\n    EP->>Store: Calculate delta [dx, dy]\n    EP->>Store: Update point position\n    \n    EP->>PP: updatePathData(pointId, newPosition)\n    PP->>PP: Modify path command\n    PP->>PP: Regenerate SVG path string\n    PP->>EP: Return updated path data\n    \n    EP->>Store: Update element path\n    Store->>Canvas: Re-render path (preview)\n    Store->>UI: Update coordinate display\n    \n    loop While Dragging\n        Canvas->>EP: handlePointMove\n        EP->>PP: Update path\n        PP->>Canvas: Render preview\n    end\n    \n    User->>Canvas: Release point\n    Canvas->>EP: handlePointUp(event)\n    EP->>Store: Commit path changes\n    Store->>EB: Publish 'path:modified'\n    EB->>Store: Add to undo stack\n    \n    Note over User,Canvas: 4. Bezier Handle Manipulation\n    User->>Canvas: Drag bezier handle\n    Canvas->>EP: handleHandleMove(handleId, event)\n    EP->>PP: updateControlPoint(handleId, position)\n    PP->>PP: Update C command parameters\n    \n    alt Symmetric Handles\n        PP->>PP: Mirror opposite handle\n    else Asymmetric\n        PP->>PP: Independent handle\n    end\n    \n    PP->>EP: Return updated curve\n    EP->>Store: Update path\n    Store->>Canvas: Re-render smooth curve\n    \n    Note over User,Canvas: 5. Convert Point Type\n    User->>UI: Click \"Convert to Curve\" button\n    UI->>EP: convertPointType(pointId, 'curve')\n    EP->>PP: convertCommand(pointId, 'C')\n    PP->>PP: Calculate control points\n    PP->>PP: Insert bezier handles\n    PP->>EP: Return converted path\n    EP->>Store: updateElement(newPath)\n    Store->>EB: Publish 'path:converted'\n    EB->>Canvas: Draw new handles\n    \n    Note over User,Canvas: 6. Smooth Brush Operation\n    User->>UI: Activate smooth brush\n    UI->>EP: setTool('smoothBrush')\n    EP->>Store: Set smoothBrush.active = true\n    \n    User->>Canvas: Drag over path segment\n    Canvas->>EP: handleSmoothDrag(event)\n    EP->>PP: getPointsInRadius(mousePos, brushSize)\n    PP->>EP: Return affected points\n    \n    loop For each affected point\n        EP->>PP: smoothPoint(pointId, strength)\n        PP->>PP: Apply smoothing algorithm\n        PP->>PP: Average neighboring positions\n    end\n    \n    PP->>EP: Return smoothed path\n    EP->>Store: Update path (live preview)\n    Store->>Canvas: Re-render smoothed section\n    \n    User->>Canvas: Release smooth brush\n    Canvas->>EP: handleSmoothUp(event)\n    EP->>Store: Commit smoothed path\n    Store->>EB: Publish 'path:smoothed'\n    \n    Note over User,Canvas: 7. Delete Point\n    User->>Canvas: Select point\n    User->>UI: Press Delete key\n    UI->>EP: deleteSelectedPoints()\n    EP->>PP: removePoint(pointId)\n    PP->>PP: Update path commands\n    PP->>PP: Connect adjacent points\n    PP->>EP: Return updated path\n    EP->>Store: updateElement(newPath)\n    Store->>EB: Publish 'points:deleted'\n    EB->>Canvas: Re-render path\n    \n    Note over User,Canvas: 8. Path Simplification\n    User->>UI: Click \"Simplify\" + set tolerance\n    UI->>EP: simplifyPath(tolerance)\n    EP->>PP: analyzePathComplexity()\n    PP->>PP: Apply Ramer-Douglas-Peucker\n    PP->>PP: Remove redundant points\n    PP->>EP: Return simplified path\n    EP->>Store: updateElement(simplified)\n    Store->>Canvas: Re-render with fewer points"}),"\n",(0,a.jsx)(n.h2,{id:"point-editing-system",children:"Point Editing System"}),"\n",(0,a.jsx)(n.mermaid,{value:"flowchart TD\n    A[Parse SVG Path] --\x3e B[Extract Commands]\n    B --\x3e C{Command Type?}\n    \n    C --\x3e|M/L| D[Line Points]\n    C --\x3e|C| E[Cubic Bezier]\n    C --\x3e|Q| F[Quadratic Bezier]\n    C --\x3e|A| G[Arc]\n    \n    D --\x3e H[Create Control Point]\n    E --\x3e I[Create Point + 2 Handles]\n    F --\x3e J[Create Point + 1 Handle]\n    G --\x3e K[Create Arc Controls]\n    \n    H --\x3e L[Store Point Data]\n    I --\x3e L\n    J --\x3e L\n    K --\x3e L\n    \n    L --\x3e M[Render Points on Canvas]\n    M --\x3e N[User Interaction]\n    \n    N --\x3e O{Action?}\n    O --\x3e|Drag Point| P[Update Position]\n    O --\x3e|Drag Handle| Q[Update Curve]\n    O --\x3e|Delete| R[Remove Point]\n    O --\x3e|Convert Type| S[Change Command]\n    O --\x3e|Smooth| T[Apply Smoothing]\n    \n    P --\x3e U[Rebuild Path]\n    Q --\x3e U\n    R --\x3e U\n    S --\x3e U\n    T --\x3e U\n    \n    U --\x3e V[Update SVG Path String]\n    V --\x3e W[Commit to Store]\n    W --\x3e X[Re-render Canvas]\n    \n    style E fill:#e1f5ff\n    style T fill:#ffe1e1\n    style W fill:#e1ffe1"}),"\n",(0,a.jsx)(n.h2,{id:"state-management",children:"State Management"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Edit Plugin Slice"\n        ES[Edit State]\n        ES --\x3e SP[selectedPoints: string array]\n        ES --\x3e EP[editablePoints: Map]\n        ES --\x3e CT[currentTool: string]\n        ES --\x3e SB[smoothBrush: Settings]\n        ES --\x3e ST[simplifyTolerance: number]\n    end\n    \n    subgraph "Point Types"\n        PT[Point Types]\n        PT --\x3e AP[Anchor Point]\n        PT --\x3e CP[Control Point]\n        PT --\x3e HP[Handle Point]\n    end\n    \n    subgraph "Command Conversion"\n        CC[Conversions]\n        CC --\x3e LTC[Line to Curve]\n        CC --\x3e CTL[Curve to Line]\n        CC --\x3e QTC[Quadratic to Cubic]\n    end\n    \n    subgraph "Path Operations"\n        PO[Operations]\n        PO --\x3e SM[Smooth]\n        PO --\x3e SMP[Simplify]\n        PO --\x3e SPL[Split]\n        PO --\x3e JN[Join]\n    end\n    \n    ES --\x3e PT\n    PT --\x3e CC\n    CC --\x3e PO\n    PO --\x3e ES'}),"\n",(0,a.jsx)(n.h2,{id:"handler",children:"Handler"}),"\n",(0,a.jsx)(n.p,{children:"Select and drag control points and handles"}),"\n",(0,a.jsx)(n.h2,{id:"keyboard-shortcuts",children:"Keyboard Shortcuts"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Delete"}),": Delete selected points"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"ui-contributions",children:"UI Contributions"}),"\n",(0,a.jsx)(n.h3,{id:"panels",children:"Panels"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Point editing controls, smooth brush settings, simplification"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"overlays",children:"Overlays"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"EditPointsOverlay"}),": Visual rendering of control points and handles for path editing"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"AddPointFeedbackOverlay"}),": Visual feedback when adding new points to paths"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"canvas-layers",children:"Canvas Layers"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Control points, handles, and smooth brush visualization"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"public-apis",children:"Public APIs"}),"\n",(0,a.jsx)(n.p,{children:"No public APIs exposed."}),"\n",(0,a.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Activate the plugin\nconst state = useCanvasStore.getState();\nstate.setMode('edit');\n\n// Access plugin state\nconst editState = useCanvasStore(state => state.edit);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Location"}),": ",(0,a.jsx)(n.code,{children:"src/plugins/edit/"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Files"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"index.ts"}),": Plugin definition"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"slice.ts"}),": Zustand slice (if applicable)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"*Panel.tsx"}),": UI panels (if applicable)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"*Overlay.tsx"}),": Overlays (if applicable)"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"edge-cases--limitations",children:"Edge Cases & Limitations"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Implementation-specific constraints"}),"\n",(0,a.jsx)(n.li,{children:"Performance considerations for large datasets"}),"\n",(0,a.jsx)(n.li,{children:"Browser compatibility notes (if any)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../overview",children:"Plugin System Overview"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../../event-bus/overview",children:"Event Bus"})}),"\n"]})]})}function P(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(6540);const a={},s=i.createContext(a);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);