"use strict";(self.webpackChunkttpe_docs=self.webpackChunkttpe_docs||[]).push([[3479],{6312:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/catalog/shape","title":"Shape Plugin","description":"Purpose: Create parametric shapes (circle, square, triangle, etc.)","source":"@site/docs/plugins/catalog/shape.md","sourceDirName":"plugins/catalog","slug":"/plugins/catalog/shape","permalink":"/ttpe/docs/docs/plugins/catalog/shape","draft":false,"unlisted":false,"editUrl":"https://github.com/ekrsulov/ttpe/tree/main/doc/docs/plugins/catalog/shape.md","tags":[],"version":"current","lastUpdatedBy":"Ernesto Krsulovic","lastUpdatedAt":1762144584000,"frontMatter":{"id":"shape","title":"Shape Plugin","sidebar_label":"Shape"},"sidebar":"docs","previous":{"title":"Text","permalink":"/ttpe/docs/docs/plugins/catalog/text"},"next":{"title":"Transformation","permalink":"/ttpe/docs/docs/plugins/catalog/transformation"}}');var a=t(4848),s=t(8453);const r={id:"shape",title:"Shape Plugin",sidebar_label:"Shape"},l="Shape Plugin",o={},d=[{value:"Overview",id:"overview",level:2},{value:"Plugin Interaction Flow",id:"plugin-interaction-flow",level:2},{value:"Shape Generation Process",id:"shape-generation-process",level:2},{value:"State Management",id:"state-management",level:2},{value:"Handler",id:"handler",level:2},{value:"Keyboard Shortcuts",id:"keyboard-shortcuts",level:2},{value:"Modifier Keys",id:"modifier-keys",level:3},{value:"Line Constraints with Shift",id:"line-constraints-with-shift",level:4},{value:"UI Contributions",id:"ui-contributions",level:2},{value:"Panels",id:"panels",level:3},{value:"Overlays",id:"overlays",level:3},{value:"Canvas Layers",id:"canvas-layers",level:3},{value:"Public APIs",id:"public-apis",level:2},{value:"<code>createShape(startPoint: Point, endPoint: Point)</code>",id:"createshapestartpoint-point-endpoint-point",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Edge Cases &amp; Limitations",id:"edge-cases--limitations",level:2},{value:"Related",id:"related",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"shape-plugin",children:"Shape Plugin"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Purpose"}),": Create parametric shapes (circle, square, triangle, etc.)"]}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Shapes: square, rectangle, circle, triangle, line, diamond, heart"}),"\n",(0,a.jsx)(n.li,{children:"Two-point creation (drag to define size)"}),"\n",(0,a.jsxs)(n.li,{children:["Shift key for proportional shapes:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Circle/Rectangle"}),": Creates perfect circles and squares"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Triangle"}),": Creates equilateral triangles"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Line"}),": Constrains to horizontal, vertical, or 45\xb0 diagonal angles"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"Preview during creation"}),"\n",(0,a.jsx)(n.li,{children:"Converts to editable paths"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"plugin-interaction-flow",children:"Plugin Interaction Flow"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant User\n    participant UI as UI/Toolbar\n    participant Store as Canvas Store\n    participant SHP as Shape Plugin\n    participant Canvas as Canvas Renderer\n    participant SG as Shape Generator\n    \n    Note over User,Canvas: 1. Tool Activation & Shape Selection\n    User->>UI: Click Shape Tool\n    UI->>Store: setActivePlugin('shape')\n    Store->>Store: Update activePlugin\n    Store->>Store: Set default shape type (circle)\n    Canvas->>Canvas: Set cursor to crosshair\n    \n    User->>UI: Select Triangle from shape panel\n    UI->>Store: Update currentShapeType\n    Store->>UI: Update panel selection\n    \n    Note over User,Canvas: 2. Start Shape Creation\n    User->>Canvas: Press pointer down\n    Canvas->>SHP: handler(event, point)\n    SHP->>Store: Set isCreating = true\n    SHP->>Store: Store startPoint [x, y]\n    SHP->>Store: Check Shift key state\n    SHP->>Store: Initialize preview shape\n    \n    Note over User,Canvas: 3. Shape Preview During Drag\n    User->>Canvas: Drag pointer\n    Canvas->>SHP: Internal pointermove handling\n    SHP->>SHP: Check isCreating\n    SHP->>Store: Get startPoint\n    SHP->>SHP: Calculate endPoint [x, y]\n    \n    alt Shift Key Pressed\n        SHP->>SHP: Calculate proportional dimensions\n        SHP->>SHP: Constrain to 1:1 aspect ratio\n    else Normal Drag\n        SHP->>SHP: Use actual dimensions\n    end\n    \n    SHP->>SG: generateShape(type, startPoint, endPoint)\n    SG->>SG: Calculate shape parameters\n    \n    alt Circle\n        SG->>SG: radius = distance / 2\n        SG->>SG: Create circle path\n    else Rectangle\n        SG->>SG: width, height from points\n        SG->>SG: Create rect path\n    else Triangle\n        SG->>SG: Calculate 3 vertices\n        SG->>SG: Create triangle path\n    else Other shapes\n        SG->>SG: Shape-specific calculations\n    end\n    \n    SG->>SHP: Return preview SVG path\n    SHP->>Store: Update preview shape data\n    Store->>Canvas: Draw preview shape (dashed)\n    \n    loop While Dragging\n        Canvas->>SHP: Process pointermove\n        SHP->>SG: generateShape\n        SG->>Canvas: Update preview\n    end\n    \n    Note over User,Canvas: 4. Complete Shape Creation\n    User->>Canvas: Release pointer\n    Canvas->>SHP: Internal pointerup handling\n    SHP->>Store: Set isCreating = false\n    SHP->>SG: generateShape(final dimensions)\n    SG->>SHP: Return final SVG path\n    \n    SHP->>SHP: Validate shape (min size check)\n    \n    alt Valid Shape\n        SHP->>Store: Create CanvasElement\n        SHP->>Store: Set element type = 'path'\n        SHP->>Store: Add shape metadata\n        SHP->>Store: addElement(shapeElement)\n        Store->>Canvas: Render final shape\n        Store->>Store: Add to undo stack\n    else Too Small\n        SHP->>SHP: Discard shape\n    end\n    \n    SHP->>Store: Clear preview state\n    \n    Note over User,Canvas: 5. Shape Type Change\n    User->>UI: Select Heart shape\n    UI->>Store: Update currentShapeType\n    Store->>UI: Highlight heart button"}),"\n",(0,a.jsx)(n.h2,{id:"shape-generation-process",children:"Shape Generation Process"}),"\n",(0,a.jsx)(n.mermaid,{value:"flowchart TD\n    A[User Starts Drag] --\x3e B[Store Start Point]\n    B --\x3e C{Shape Type?}\n    \n    C --\x3e|Circle| D1[Calculate Radius]\n    C --\x3e|Rectangle| D2[Calculate Width/Height]\n    C --\x3e|Triangle| D3[Calculate Vertices]\n    C --\x3e|Line| D4[Calculate Line Points]\n    C --\x3e|Diamond| D5[Calculate 4 Points]\n    C --\x3e|Heart| D6[Heart Bezier Curves]\n    \n    D1 --\x3e E1{Shift Key?}\n    D2 --\x3e E2{Shift Key?}\n    D3 --\x3e E3{Shift Key?}\n    D4 --\x3e E4{Shift Key?}\n    \n    E1 --\x3e|Yes| F1[Perfect Circle]\n    E1 --\x3e|No| F1b[Ellipse]\n    E2 --\x3e|Yes| F2[Square]\n    E2 --\x3e|No| F2b[Rectangle]\n    E3 --\x3e|Yes| F3[Equilateral Triangle]\n    E3 --\x3e|No| F3b[Scalene Triangle]\n    E4 --\x3e|Yes| F4[Constrained Line]\n    E4 --\x3e|No| F4b[Free Line]\n    \n    F4 --\x3e F4_1{Angle?}\n    F4_1 --\x3e|0\xb0 or 180\xb0| F4_H[Horizontal Line]\n    F4_1 --\x3e|90\xb0 or 270\xb0| F4_V[Vertical Line]\n    F4_1 --\x3e|45\xb0, 135\xb0, 225\xb0, 315\xb0| F4_D[Diagonal Line]\n    \n    D5 --\x3e G5[Diamond Path]\n    D6 --\x3e G6[Heart Path]\n    \n    F1 --\x3e H[Generate SVG Path]\n    F1b --\x3e H\n    F2 --\x3e H\n    F2b --\x3e H\n    F3 --\x3e H\n    F3b --\x3e H\n    F4b --\x3e H\n    F4_H --\x3e H\n    F4_V --\x3e H\n    F4_D --\x3e H\n    G5 --\x3e H\n    G6 --\x3e H\n    \n    H --\x3e I[Update Preview]\n    I --\x3e J{Still Dragging?}\n    J --\x3e|Yes| K[Wait for Move Event]\n    K --\x3e C\n    J --\x3e|No| L[Pointer Up]\n    \n    L --\x3e M{Valid Size?}\n    M --\x3e|Yes| N[Create Element]\n    M --\x3e|No| O[Discard]\n    \n    N --\x3e P[Add to Canvas]\n    P --\x3e Q[Clear Preview]\n    \n    style D1 fill:#e1f5ff\n    style D2 fill:#e1f5ff\n    style D3 fill:#e1f5ff\n    style D4 fill:#e1f5ff\n    style F4 fill:#fff4e1\n    style F4_H fill:#e1ffe1\n    style F4_V fill:#e1ffe1\n    style F4_D fill:#e1ffe1\n    style N fill:#e1ffe1\n    style O fill:#ffe1e1"}),"\n",(0,a.jsx)(n.h2,{id:"state-management",children:"State Management"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Shape Plugin Slice"\n        SS[Shape State]\n        SS --\x3e CT[currentType: ShapeType]\n        SS --\x3e IC[isCreating: boolean]\n        SS --\x3e SP[startPoint: Point]\n        SS --\x3e EP[endPoint: Point]\n        SS --\x3e PS[previewShape: PathData]\n        SS --\x3e SK[shiftKey: boolean]\n    end\n    \n    subgraph "Shape Types"\n        ST[Available Shapes]\n        ST --\x3e C[circle]\n        ST --\x3e R[rectangle]\n        ST --\x3e T[triangle]\n        ST --\x3e L[line]\n        ST --\x3e D[diamond]\n        ST --\x3e H[heart]\n        ST --\x3e S[star]\n    end\n    \n    subgraph "Shape Generator Utilities"\n        SG[Shape Generators]\n        SG --\x3e CG[CircleGenerator]\n        SG --\x3e RG[RectGenerator]\n        SG --\x3e TG[TriangleGenerator]\n        SG --\x3e DG[DiamondGenerator]\n        SG --\x3e HG[HeartGenerator]\n    end\n    \n    SS --\x3e ST\n    ST --\x3e SG\n    SG --\x3e SS'}),"\n",(0,a.jsx)(n.h2,{id:"handler",children:"Handler"}),"\n",(0,a.jsx)(n.p,{children:"Two-point shape creation with preview"}),"\n",(0,a.jsx)(n.h2,{id:"keyboard-shortcuts",children:"Keyboard Shortcuts"}),"\n",(0,a.jsx)(n.p,{children:"No plugin-specific shortcuts."}),"\n",(0,a.jsx)(n.h3,{id:"modifier-keys",children:"Modifier Keys"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.strong,{children:"Shift"})," key provides constrained drawing for different shape types:"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Shape Type"}),(0,a.jsx)(n.th,{children:"Normal Behavior"}),(0,a.jsx)(n.th,{children:"Shift Key Behavior"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Circle"})}),(0,a.jsx)(n.td,{children:"Free ellipse"}),(0,a.jsx)(n.td,{children:"Perfect circle (1:1 aspect ratio)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Rectangle"})}),(0,a.jsx)(n.td,{children:"Free rectangle"}),(0,a.jsx)(n.td,{children:"Perfect square (1:1 aspect ratio)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Triangle"})}),(0,a.jsx)(n.td,{children:"Scalene triangle"}),(0,a.jsx)(n.td,{children:"Equilateral triangle"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Line"})}),(0,a.jsx)(n.td,{children:"Free angle line"}),(0,a.jsxs)(n.td,{children:["Constrained to 8 directions:",(0,a.jsx)("br",{}),"- Horizontal (0\xb0, 180\xb0)",(0,a.jsx)("br",{}),"- Vertical (90\xb0, 270\xb0)",(0,a.jsx)("br",{}),"- Diagonal (45\xb0, 135\xb0, 225\xb0, 315\xb0)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Diamond"})}),(0,a.jsx)(n.td,{children:"Free diamond"}),(0,a.jsx)(n.td,{children:"Square diamond"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Heart"})}),(0,a.jsx)(n.td,{children:"No constraint"}),(0,a.jsx)(n.td,{children:"No constraint"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Star"})}),(0,a.jsx)(n.td,{children:"No constraint"}),(0,a.jsx)(n.td,{children:"No constraint"})]})]})]}),"\n",(0,a.jsx)(n.h4,{id:"line-constraints-with-shift",children:"Line Constraints with Shift"}),"\n",(0,a.jsx)(n.p,{children:"When drawing lines with Shift pressed, the line snaps to the nearest 45\xb0 angle:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"        90\xb0 (\u2191)\n         |\n135\xb0 \u2196  |  \u2197 45\xb0\n    ----+----  0\xb0 (\u2192)\n225\xb0 \u2199  |  \u2198 315\xb0\n         |\n       270\xb0 (\u2193)\n"})}),"\n",(0,a.jsx)(n.p,{children:"This makes it easy to draw perfectly horizontal, vertical, or diagonal lines without manual precision."}),"\n",(0,a.jsx)(n.h2,{id:"ui-contributions",children:"UI Contributions"}),"\n",(0,a.jsx)(n.h3,{id:"panels",children:"Panels"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Shape type selector"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"overlays",children:"Overlays"}),"\n",(0,a.jsx)(n.p,{children:"No overlays."}),"\n",(0,a.jsx)(n.h3,{id:"canvas-layers",children:"Canvas Layers"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Preview layer showing shape during creation"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"public-apis",children:"Public APIs"}),"\n",(0,a.jsx)(n.p,{children:"The Shape plugin exposes the following public API:"}),"\n",(0,a.jsx)(n.h3,{id:"createshapestartpoint-point-endpoint-point",children:(0,a.jsx)(n.code,{children:"createShape(startPoint: Point, endPoint: Point)"})}),"\n",(0,a.jsx)(n.p,{children:"Creates a shape between two points."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"startPoint"}),": A ",(0,a.jsx)(n.code,{children:"Point"})," object with ",(0,a.jsx)(n.code,{children:"x"})," and ",(0,a.jsx)(n.code,{children:"y"})," coordinates for the start position"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"endPoint"}),": A ",(0,a.jsx)(n.code,{children:"Point"})," object with ",(0,a.jsx)(n.code,{children:"x"})," and ",(0,a.jsx)(n.code,{children:"y"})," coordinates for the end position"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Usage"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"const api = useCanvasStore.getState().getPluginApi('shape');\napi.createShape(\n  { x: 50, y: 50 },\n  { x: 150, y: 150 }\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"// Activate the plugin\nconst state = useCanvasStore.getState();\nstate.setMode('shape');\n\n// Access plugin state\nconst shapeState = useCanvasStore(state => state.shape);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Location"}),": ",(0,a.jsx)(n.code,{children:"src/plugins/shape/"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Files"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"index.ts"}),": Plugin definition"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"slice.ts"}),": Zustand slice (if applicable)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"*Panel.tsx"}),": UI panels (if applicable)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"*Overlay.tsx"}),": Overlays (if applicable)"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"edge-cases--limitations",children:"Edge Cases & Limitations"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Implementation-specific constraints"}),"\n",(0,a.jsx)(n.li,{children:"Performance considerations for large datasets"}),"\n",(0,a.jsx)(n.li,{children:"Browser compatibility notes (if any)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../overview",children:"Plugin System Overview"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../../event-bus/overview",children:"Event Bus"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);