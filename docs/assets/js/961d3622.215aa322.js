"use strict";(self.webpackChunkttpe_docs=self.webpackChunkttpe_docs||[]).push([[8098],{8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>r});var i=t(6540);const s={},a=i.createContext(s);function l(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(a.Provider,{value:n},e.children)}},9292:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"plugins/catalog/text","title":"Text Plugin","description":"Purpose: Convert text to vector paths using font rendering","source":"@site/docs/plugins/catalog/text.md","sourceDirName":"plugins/catalog","slug":"/plugins/catalog/text","permalink":"/ttpe/docs/plugins/catalog/text","draft":false,"unlisted":false,"editUrl":"https://github.com/ekrsulov/ttpe/tree/main/doc/docs/plugins/catalog/text.md","tags":[],"version":"current","lastUpdatedBy":"Ernesto Krsulovic","lastUpdatedAt":1762144179000,"frontMatter":{"id":"text","title":"Text Plugin","sidebar_label":"Text"},"sidebar":"docs","previous":{"title":"Pencil","permalink":"/ttpe/docs/plugins/catalog/pencil"},"next":{"title":"Shape","permalink":"/ttpe/docs/plugins/catalog/shape"}}');var s=t(4848),a=t(8453);const l={id:"text",title:"Text Plugin",sidebar_label:"Text"},r="Text Plugin",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Plugin Interaction Flow",id:"plugin-interaction-flow",level:2},{value:"Text-to-Path Conversion",id:"text-to-path-conversion",level:2},{value:"State Management",id:"state-management",level:2},{value:"Handler",id:"handler",level:2},{value:"Keyboard Shortcuts",id:"keyboard-shortcuts",level:2},{value:"UI Contributions",id:"ui-contributions",level:2},{value:"Panels",id:"panels",level:3},{value:"Overlays",id:"overlays",level:3},{value:"Canvas Layers",id:"canvas-layers",level:3},{value:"Public APIs",id:"public-apis",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Edge Cases &amp; Limitations",id:"edge-cases--limitations",level:2},{value:"Related",id:"related",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"text-plugin",children:"Text Plugin"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Convert text to vector paths using font rendering"]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Text-to-curves conversion"}),"\n",(0,s.jsx)(n.li,{children:"Font family, size, weight, style selection"}),"\n",(0,s.jsx)(n.li,{children:"Uses WASM (potrace) for rendering"}),"\n",(0,s.jsx)(n.li,{children:"Applies current stroke/fill settings"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"plugin-interaction-flow",children:"Plugin Interaction Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant User\n    participant UI as Text Panel\n    participant TP as Text Plugin\n    participant Store as Canvas Store\n    participant WASM as OpenType WASM\n    participant PP as Path Processor\n    participant EB as Event Bus\n    participant Canvas as Canvas Renderer\n    \n    Note over User,Canvas: 1. Plugin Activation\n    User->>UI: Click Text Tool\n    UI->>Store: setMode(\'text\')\n    Store->>TP: activate()\n    TP->>Store: Initialize text slice\n    TP->>WASM: Load font library\n    WASM->>TP: Font system ready\n    TP->>EB: Publish \'plugin:activated\'\n    EB->>UI: Show text panel\n    \n    Note over User,Canvas: 2. Enter Text\n    User->>UI: Type "Hello" in text input\n    UI->>TP: setText("Hello")\n    TP->>Store: Update text.content\n    Store->>UI: Update input value\n    \n    Note over User,Canvas: 3. Select Font\n    User->>UI: Select "Arial" from font dropdown\n    UI->>TP: setFontFamily("Arial")\n    TP->>Store: Update text.fontFamily\n    TP->>WASM: Load font file\n    WASM->>TP: Font loaded\n    \n    Note over User,Canvas: 4. Adjust Font Properties\n    User->>UI: Set font size to 48px\n    UI->>TP: setFontSize(48)\n    TP->>Store: Update text.fontSize\n    \n    User->>UI: Set font weight to "bold"\n    UI->>Store: Update fontWeight\n    \n    Note over User,Canvas: 5. Create Text Path\n    User->>Canvas: Click on canvas\n    Canvas->>TP: handler(event, point)\n    \n    TP->>Store: Get text properties\n    TP->>WASM: renderText(content, font, size, weight)\n    \n    WASM->>WASM: Parse font glyphs\n    WASM->>WASM: Scale to font size\n    WASM->>WASM: Apply font weight\n    WASM->>WASM: Position characters\n    \n    loop For each character\n        WASM->>WASM: Get glyph outline\n        WASM->>WASM: Convert to path commands\n        WASM->>TP: Return glyph path data\n        TP->>PP: processGlyphPath(pathData)\n        PP->>PP: Optimize path\n        PP->>TP: Return optimized path\n    end\n    \n    TP->>TP: Combine all glyph paths\n    TP->>TP: Calculate bounding box\n    TP->>TP: Apply baseline alignment\n    TP->>TP: Position at click point\n    \n    TP->>Store: Get current stroke/fill settings\n    TP->>TP: Apply styling to paths\n    \n    TP->>Store: addElement(textPath)\n    Store->>Store: Add to undo stack\n    Canvas->>Canvas: Render text as path'}),"\n",(0,s.jsx)(n.h2,{id:"text-to-path-conversion",children:"Text-to-Path Conversion"}),"\n",(0,s.jsx)(n.mermaid,{value:"flowchart TD\n    A[Text Input] --\x3e B[Get Font Data]\n    B --\x3e C[Parse Text String]\n    C --\x3e D[Split into Characters]\n    \n    D --\x3e E{For Each Character}\n    E --\x3e F[Get Glyph ID]\n    F --\x3e G[Load Glyph Outline]\n    \n    G --\x3e H[Scale to Font Size]\n    H --\x3e I[Apply Font Weight]\n    I --\x3e J[Convert to Path Commands]\n    \n    J --\x3e K{Kerning Enabled?}\n    K --\x3e|Yes| L[Apply Kerning Table]\n    K --\x3e|No| M[Use Default Spacing]\n    \n    L --\x3e N[Position Glyph]\n    M --\x3e N\n    \n    N --\x3e O[Add to Path Array]\n    O --\x3e E\n    \n    E --\x3e P[All Characters Done]\n    P --\x3e Q[Combine Paths]\n    Q --\x3e R[Calculate Bounds]\n    R --\x3e S[Apply Alignment]\n    \n    S --\x3e T{Styling Options?}\n    T --\x3e|Stroke| U[Add Stroke Properties]\n    T --\x3e|Fill| V[Add Fill Properties]\n    T --\x3e|Both| W[Add Both]\n    \n    U --\x3e X[Create Canvas Elements]\n    V --\x3e X\n    W --\x3e X\n    \n    X --\x3e Y[Add to Store]\n    Y --\x3e Z[Render on Canvas]\n    \n    style G fill:#e1f5ff\n    style J fill:#ffe1e1\n    style Y fill:#e1ffe1"}),"\n",(0,s.jsx)(n.h2,{id:"state-management",children:"State Management"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Text Plugin Slice"\n        TS[Text State]\n        TS --\x3e TC[content: string]\n        TS --\x3e FF[fontFamily: string]\n        TS --\x3e FS[fontSize: number]\n        TS --\x3e FW[fontWeight: string]\n        TS --\x3e FT[fontStyle: string]\n    end\n    \n    subgraph "WASM Integration"\n        WI[OpenType WASM]\n        WI --\x3e FL[Font Loader]\n        WI --\x3e GP[Glyph Parser]\n        WI --\x3e PR[Path Renderer]\n    end\n    \n    subgraph "Path Processing"\n        PP[Path Processor]\n        PP --\x3e OPT[Optimize]\n        PP --\x3e SIM[Simplify]\n        PP --\x3e STY[Apply Styling]\n    end\n    \n    TS --\x3e WI\n    WI --\x3e PP\n    PP --\x3e TS'}),"\n",(0,s.jsx)(n.h2,{id:"handler",children:"Handler"}),"\n",(0,s.jsx)(n.p,{children:"Responds to pointer events when text content is available and creates text paths on canvas click."}),"\n",(0,s.jsx)(n.h2,{id:"keyboard-shortcuts",children:"Keyboard Shortcuts"}),"\n",(0,s.jsx)(n.p,{children:"No plugin-specific shortcuts."}),"\n",(0,s.jsx)(n.h2,{id:"ui-contributions",children:"UI Contributions"}),"\n",(0,s.jsx)(n.h3,{id:"panels",children:"Panels"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Text input, font selection, size, weight, style"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"overlays",children:"Overlays"}),"\n",(0,s.jsx)(n.p,{children:"No overlays."}),"\n",(0,s.jsx)(n.h3,{id:"canvas-layers",children:"Canvas Layers"}),"\n",(0,s.jsx)(n.p,{children:"No canvas layers."}),"\n",(0,s.jsx)(n.h2,{id:"public-apis",children:"Public APIs"}),"\n",(0,s.jsx)(n.p,{children:"No public APIs exposed."}),"\n",(0,s.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Activate the plugin\nconst state = useCanvasStore.getState();\nstate.setMode('text');\n\n// Access plugin state\nconst textState = useCanvasStore(state => state.text);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/plugins/text/"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Files"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"index.ts"}),": Plugin definition"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"slice.ts"}),": Zustand slice (if applicable)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"*Panel.tsx"}),": UI panels (if applicable)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"*Overlay.tsx"}),": Overlays (if applicable)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"edge-cases--limitations",children:"Edge Cases & Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implementation-specific constraints"}),"\n",(0,s.jsx)(n.li,{children:"Performance considerations for large datasets"}),"\n",(0,s.jsx)(n.li,{children:"Browser compatibility notes (if any)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../overview",children:"Plugin System Overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../event-bus/overview",children:"Event Bus"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);