"use strict";(self.webpackChunkttpe_docs=self.webpackChunkttpe_docs||[]).push([[388],{5912:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"plugins/catalog/grid","title":"Grid Plugin","description":"Purpose: Display reference grids with optional snapping","source":"@site/docs/plugins/catalog/grid.md","sourceDirName":"plugins/catalog","slug":"/plugins/catalog/grid","permalink":"/ttpe/docs/plugins/catalog/grid","draft":false,"unlisted":false,"editUrl":"https://github.com/ekrsulov/ttpe/tree/main/doc/docs/plugins/catalog/grid.md","tags":[],"version":"current","lastUpdatedBy":"Ernesto Krsulovic","lastUpdatedAt":1762144179000,"frontMatter":{"id":"grid","title":"Grid Plugin","sidebar_label":"Grid"},"sidebar":"docs","previous":{"title":"Guidelines","permalink":"/ttpe/docs/plugins/catalog/guidelines"},"next":{"title":"Grid Fill","permalink":"/ttpe/docs/plugins/catalog/grid-fill"}}');var r=i(4848),s=i(8453);const t={id:"grid",title:"Grid Plugin",sidebar_label:"Grid"},l="Grid Plugin",d={},o=[{value:"Overview",id:"overview",level:2},{value:"Plugin Interaction Flow",id:"plugin-interaction-flow",level:2},{value:"Grid Generation Process",id:"grid-generation-process",level:2},{value:"Snap System",id:"snap-system",level:2},{value:"Handler",id:"handler",level:2},{value:"Keyboard Shortcuts",id:"keyboard-shortcuts",level:2},{value:"UI Contributions",id:"ui-contributions",level:2},{value:"Panels",id:"panels",level:3},{value:"Overlays",id:"overlays",level:3},{value:"Canvas Layers",id:"canvas-layers",level:3},{value:"Public APIs",id:"public-apis",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Edge Cases &amp; Limitations",id:"edge-cases--limitations",level:2},{value:"Related",id:"related",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"grid-plugin",children:"Grid Plugin"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Display reference grids with optional snapping"]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Grid types: square, isometric, triangular, hexagonal, polar, diagonal, warped"}),"\n",(0,r.jsx)(n.li,{children:"Customizable grid size and spacing"}),"\n",(0,r.jsx)(n.li,{children:"Warp effects: sine2d, perlin2d, radial"}),"\n",(0,r.jsx)(n.li,{children:"Optional snapping to grid"}),"\n",(0,r.jsx)(n.li,{children:"Show/hide toggle"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"plugin-interaction-flow",children:"Plugin Interaction Flow"}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant User\n    participant UI as UI/Panel\n    participant GP as Grid Plugin\n    participant Store as Canvas Store\n    participant EB as Event Bus\n    participant Canvas as Canvas Renderer\n    participant GG as Grid Generator\n    participant SM as Snap Manager\n    \n    Note over User,Canvas: 1. Plugin Initialization (Always Active)\n    activate GP\n    GP->>Store: Initialize grid slice\n    GP->>Store: Set default grid type (square)\n    GP->>Store: Set visible = false\n    GP->>EB: Subscribe to canvas events\n    \n    Note over User,Canvas: 2. Enable Grid Display\n    User->>UI: Toggle \"Show Grid\" checkbox\n    UI->>GP: setVisible(true)\n    GP->>Store: Update grid.visible = true\n    Store->>GG: requestGridGeneration()\n    \n    GG->>Store: Get canvas bounds\n    GG->>Store: Get grid settings (type, size, spacing)\n    \n    alt Grid Type: Square\n        GG->>GG: generateSquareGrid()\n    else Grid Type: Isometric\n        GG->>GG: generateIsometricGrid()\n    else Grid Type: Hexagonal\n        GG->>GG: generateHexagonalGrid()\n    else Grid Type: Polar\n        GG->>GG: generatePolarGrid()\n    else Grid Type: Warped\n        GG->>GG: generateWarpedGrid(warpType)\n    end\n    \n    GG->>GP: Return grid line coordinates\n    GP->>Store: Set grid lines data\n    Store->>EB: Publish 'grid:updated'\n    EB->>Canvas: Draw grid layer (behind elements)\n    \n    Note over User,Canvas: 3. Change Grid Type\n    User->>UI: Select \"Hexagonal\" from dropdown\n    UI->>GP: setGridType('hexagonal')\n    GP->>Store: Update grid.type\n    Store->>GG: Regenerate grid\n    GG->>GG: generateHexagonalGrid()\n    GG->>GP: Return new grid data\n    GP->>Store: Update grid lines\n    Store->>Canvas: Re-render grid\n    \n    Note over User,Canvas: 4. Adjust Grid Size\n    User->>UI: Change grid size slider to 50px\n    UI->>GP: setGridSize(50)\n    GP->>Store: Update grid.size = 50\n    Store->>GG: Regenerate with new size\n    GG->>GP: Return scaled grid\n    GP->>Store: Update grid lines\n    Store->>Canvas: Re-render grid\n    \n    Note over User,Canvas: 5. Enable Snap to Grid\n    User->>UI: Toggle \"Snap to Grid\" checkbox\n    UI->>GP: setSnapEnabled(true)\n    GP->>Store: Update grid.snapEnabled = true\n    GP->>SM: Enable snap calculations\n    \n    Note over User,Canvas: 6. Drawing with Grid Snap\n    User->>Canvas: Draw shape (e.g., with Pencil)\n    Canvas->>EB: Publish 'pointer:move' event\n    EB->>GP: Receive pointer position\n    \n    alt Snap Enabled\n        GP->>SM: snapToGrid(position)\n        SM->>SM: Find nearest grid point\n        SM->>GP: Return snapped position\n        GP->>EB: Publish 'position:snapped'\n        EB->>Canvas: Update cursor to snapped pos\n    else Snap Disabled\n        GP->>Canvas: Use raw position\n    end\n    \n    Note over User,Canvas: 7. Apply Warp Effect\n    User->>UI: Select \"Sine2D\" warp effect\n    UI->>GP: setWarpType('sine2d')\n    GP->>Store: Update grid.warpType\n    \n    User->>UI: Adjust warp amplitude slider\n    UI->>GP: setWarpAmplitude(value)\n    GP->>Store: Update grid.warpAmplitude\n    \n    Store->>GG: Regenerate warped grid\n    GG->>GG: Apply sine wave transformation\n    GG->>GG: Calculate warped coordinates\n    GG->>GP: Return warped grid data\n    GP->>Store: Update grid lines\n    Store->>Canvas: Re-render warped grid\n    \n    Note over User,Canvas: 8. Viewport Change (Auto-regenerate)\n    User->>Canvas: Zoom or pan canvas\n    Canvas->>EB: Publish 'viewport:changed'\n    EB->>GP: Handle viewport change\n    GP->>Store: Get new viewport bounds\n    GP->>GG: Regenerate for visible area\n    GG->>GP: Return optimized grid\n    GP->>Store: Update grid lines\n    Store->>Canvas: Re-render grid\n    \n    Note over User,Canvas: 9. Disable Grid\n    User->>UI: Toggle \"Show Grid\" off\n    UI->>GP: setVisible(false)\n    GP->>Store: Update grid.visible = false\n    Store->>Canvas: Clear grid layer\n    \n    deactivate GP"}),"\n",(0,r.jsx)(n.h2,{id:"grid-generation-process",children:"Grid Generation Process"}),"\n",(0,r.jsx)(n.mermaid,{value:"flowchart TD\n    A[Grid Configuration] --\x3e B{Grid Type?}\n    \n    B --\x3e|Square| C1[Calculate Rows & Columns]\n    B --\x3e|Isometric| C2[Calculate Diamond Pattern]\n    B --\x3e|Triangular| C3[Calculate Triangle Vertices]\n    B --\x3e|Hexagonal| C4[Calculate Hex Cells]\n    B --\x3e|Polar| C5[Calculate Circles & Radials]\n    B --\x3e|Diagonal| C6[Calculate Diagonal Lines]\n    \n    C1 --\x3e D1[Generate Vertical Lines]\n    C1 --\x3e D2[Generate Horizontal Lines]\n    \n    C2 --\x3e E1[Calculate 30\xb0 Angles]\n    C2 --\x3e E2[Generate Diagonal Grid]\n    \n    C4 --\x3e F1[Calculate Hex Centers]\n    F1 --\x3e F2[Generate Hex Edges]\n    \n    C5 --\x3e G1[Generate Concentric Circles]\n    G1 --\x3e G2[Generate Radial Lines]\n    \n    D1 --\x3e H{Warp Effect?}\n    D2 --\x3e H\n    E1 --\x3e H\n    F2 --\x3e H\n    G1 --\x3e H\n    C3 --\x3e H\n    C6 --\x3e H\n    \n    H --\x3e|None| I[Use Original Coordinates]\n    H --\x3e|Sine2D| J[Apply Sine Wave]\n    H --\x3e|Perlin2D| K[Apply Perlin Noise]\n    H --\x3e|Radial| L[Apply Radial Distortion]\n    \n    I --\x3e M[Generate Line Segments]\n    J --\x3e M\n    K --\x3e M\n    L --\x3e M\n    \n    M --\x3e N{Visible Area Only?}\n    N --\x3e|Yes| O[Cull Off-Screen Lines]\n    N --\x3e|No| P[Keep All Lines]\n    \n    O --\x3e Q[Return Grid Data]\n    P --\x3e Q\n    \n    Q --\x3e R[Store in Plugin State]\n    R --\x3e S[Render to Canvas]\n    \n    style C4 fill:#e1f5ff\n    style J fill:#ffe1e1\n    style S fill:#e1ffe1"}),"\n",(0,r.jsx)(n.h2,{id:"snap-system",children:"Snap System"}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Snap Manager"\n        SM[Snap System]\n        SM --\x3e SE[snapEnabled: boolean]\n        SM --\x3e ST[snapThreshold: number]\n        SM --\x3e GC[gridCache: GridPoints]\n    end\n    \n    subgraph "Snap Calculation"\n        SC[Snap Process]\n        SC --\x3e GP[Get Pointer Position]\n        GP --\x3e FN[Find Nearest Grid Point]\n        FN --\x3e CD[Calculate Distance]\n        CD --\x3e CT{Distance < Threshold?}\n        CT --\x3e|Yes| SP[Return Snapped Point]\n        CT --\x3e|No| OP[Return Original Point]\n    end\n    \n    subgraph "Grid State"\n        GS[Grid Slice]\n        GS --\x3e GT[gridType: string]\n        GS --\x3e GZ[gridSize: number]\n        GS --\x3e SP2[spacing: number]\n        GS --\x3e WA[warpAmplitude: number]\n        GS --\x3e VI[visible: boolean]\n    end\n    \n    SM --\x3e SC\n    GS --\x3e SM\n    SC --\x3e GS'}),"\n",(0,r.jsx)(n.h2,{id:"handler",children:"Handler"}),"\n",(0,r.jsx)(n.p,{children:"N/A (visual aid)"}),"\n",(0,r.jsx)(n.h2,{id:"keyboard-shortcuts",children:"Keyboard Shortcuts"}),"\n",(0,r.jsx)(n.p,{children:"No plugin-specific shortcuts."}),"\n",(0,r.jsx)(n.h2,{id:"ui-contributions",children:"UI Contributions"}),"\n",(0,r.jsx)(n.h3,{id:"panels",children:"Panels"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Grid type, size, warping parameters, snap settings"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"overlays",children:"Overlays"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"GridOverlay"}),": Visual grid rendering showing cartesian, isometric, triangular, or hexagonal grids with optional rulers"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"canvas-layers",children:"Canvas Layers"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Grid visualization"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"public-apis",children:"Public APIs"}),"\n",(0,r.jsx)(n.p,{children:"No public APIs exposed."}),"\n",(0,r.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Activate the plugin\nconst state = useCanvasStore.getState();\nstate.setMode('grid');\n\n// Access plugin state\nconst gridState = useCanvasStore(state => state.grid);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Location"}),": ",(0,r.jsx)(n.code,{children:"src/plugins/grid/"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Files"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"index.ts"}),": Plugin definition"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slice.ts"}),": Zustand slice (if applicable)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"*Panel.tsx"}),": UI panels (if applicable)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"*Overlay.tsx"}),": Overlays (if applicable)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"edge-cases--limitations",children:"Edge Cases & Limitations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implementation-specific constraints"}),"\n",(0,r.jsx)(n.li,{children:"Performance considerations for large datasets"}),"\n",(0,r.jsx)(n.li,{children:"Browser compatibility notes (if any)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"../overview",children:"Plugin System Overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"../../event-bus/overview",children:"Event Bus"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var a=i(6540);const r={},s=a.createContext(r);function t(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);