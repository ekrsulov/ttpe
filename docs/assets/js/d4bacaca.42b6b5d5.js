"use strict";(self.webpackChunkttpe_docs=self.webpackChunkttpe_docs||[]).push([[148],{7891:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"features/groups","title":"Groups","description":"The groups system provides hierarchical organization for canvas elements through nestable group containers. Groups enable you to organize related elements into logical units, apply collective transformations, manage visibility/lock states hierarchically, and maintain clean layer structures in complex compositions.","source":"@site/docs/features/groups.md","sourceDirName":"features","slug":"/features/groups","permalink":"/ttpe/docs/docs/features/groups","draft":false,"unlisted":false,"editUrl":"https://github.com/ekrsulov/ttpe/tree/main/doc/docs/features/groups.md","tags":[],"version":"current","lastUpdatedBy":"Ernesto Krsulovic","lastUpdatedAt":1762144584000,"frontMatter":{"id":"groups","title":"Groups","sidebar_label":"Groups"},"sidebar":"docs","previous":{"title":"Distribution","permalink":"/ttpe/docs/docs/features/distribution"},"next":{"title":"Undo/Redo","permalink":"/ttpe/docs/docs/features/undo-redo"}}');var s=r(4848),o=r(8453);const i={id:"groups",title:"Groups",sidebar_label:"Groups"},l="Groups",d={},a=[{value:"Overview",id:"overview",level:2},{value:"Group Architecture",id:"group-architecture",level:2},{value:"Group Operations",id:"group-operations",level:2},{value:"Create Group from Selection",id:"create-group-from-selection",level:3},{value:"Ungroup Selected Groups",id:"ungroup-selected-groups",level:3},{value:"Rename Group",id:"rename-group",level:3},{value:"Toggle Group Expansion",id:"toggle-group-expansion",level:3},{value:"Toggle Group Visibility/Lock",id:"toggle-group-visibilitylock",level:3},{value:"Group Flow Diagram",id:"group-flow-diagram",level:2},{value:"API Reference",id:"api-reference",level:2},{value:"Create and Ungroup",id:"create-and-ungroup",level:3},{value:"<code>createGroupFromSelection(name?: string): string | null</code>",id:"creategroupfromselectionname-string-string--null",level:4},{value:"<code>ungroupSelectedGroups(): void</code>",id:"ungroupselectedgroups-void",level:4},{value:"<code>ungroupGroupById(groupId: string): void</code>",id:"ungroupgroupbyidgroupid-string-void",level:4},{value:"Group Properties",id:"group-properties",level:3},{value:"<code>renameGroup(groupId: string, name: string): void</code>",id:"renamegroupgroupid-string-name-string-void",level:4},{value:"<code>setGroupExpanded(groupId: string, expanded: boolean): void</code>",id:"setgroupexpandedgroupid-string-expanded-boolean-void",level:4},{value:"Group State Management",id:"group-state-management",level:3},{value:"<code>toggleGroupVisibility(groupId: string): void</code>",id:"togglegroupvisibilitygroupid-string-void",level:4},{value:"<code>toggleGroupLock(groupId: string): void</code>",id:"togglegrouplockgroupid-string-void",level:4},{value:"<code>toggleElementVisibility(elementId: string): void</code>",id:"toggleelementvisibilityelementid-string-void",level:4},{value:"<code>toggleElementLock(elementId: string): void</code>",id:"toggleelementlockelementid-string-void",level:4},{value:"Query Methods",id:"query-methods",level:3},{value:"<code>getGroupById(groupId: string): GroupElement | null</code>",id:"getgroupbyidgroupid-string-groupelement--null",level:4},{value:"<code>getGroupDescendants(groupId: string): string[]</code>",id:"getgroupdescendantsgroupid-string-string",level:4},{value:"<code>isElementHidden(elementId: string): boolean</code>",id:"iselementhiddenelementid-string-boolean",level:4},{value:"<code>isElementLocked(elementId: string): boolean</code>",id:"iselementlockedelementid-string-boolean",level:4},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Grouping",id:"basic-grouping",level:3},{value:"Nested Groups",id:"nested-groups",level:3},{value:"Manage Group State",id:"manage-group-state",level:3},{value:"Ungroup and Select Children",id:"ungroup-and-select-children",level:3},{value:"Query Descendants",id:"query-descendants",level:3},{value:"UI Integration",id:"ui-integration",level:2},{value:"Group Item Features",id:"group-item-features",level:3},{value:"Visual Hierarchy",id:"visual-hierarchy",level:3},{value:"Group Transforms",id:"group-transforms",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"For Users",id:"for-users",level:3},{value:"For Plugin Developers",id:"for-plugin-developers",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2},{value:"Organize UI Components",id:"organize-ui-components",level:3},{value:"Create Reusable Component",id:"create-reusable-component",level:3},{value:"Hierarchical Layer Management",id:"hierarchical-layer-management",level:3},{value:"Batch Visibility Control",id:"batch-visibility-control",level:3},{value:"Testing",id:"testing",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"groups",children:"Groups"})}),"\n",(0,s.jsxs)(n.p,{children:["The groups system provides ",(0,s.jsx)(n.strong,{children:"hierarchical organization"})," for canvas elements through nestable group containers. Groups enable you to organize related elements into logical units, apply collective transformations, manage visibility/lock states hierarchically, and maintain clean layer structures in complex compositions."]}),"\n",(0,s.jsx)(n.p,{children:"Groups are essential for managing large projects with dozens or hundreds of elements, creating reusable components, organizing design systems, and maintaining visual hierarchy through collapsible structures in the selection panel."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"group"})," is a special container element that holds references to child elements via their IDs. Unlike visual grouping systems that merely select multiple elements, TTPE groups establish true parent-child relationships with the following characteristics:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key characteristics:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hierarchical structure"}),": Elements reference their parent via ",(0,s.jsx)(n.code,{children:"parentId"}),", groups maintain child lists via ",(0,s.jsx)(n.code,{children:"childIds"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Named containers"}),": Each group has a customizable name for identification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transform propagation"}),": Group transforms affect all descendants"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Collective state management"}),": Visibility and lock states cascade to children"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Preserved order"}),": Child rendering order is preserved within groups"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recursive nesting"}),": Groups can contain other groups (nested hierarchies)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Non-destructive"}),": Ungrouping restores original element properties"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"group-architecture",children:"Group Architecture"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Canvas Elements Array"\n        R1[Root Element 1<br/>zIndex: 0<br/>parentId: null]\n        G1[Group A<br/>zIndex: 1<br/>parentId: null<br/>childIds: element-1, element-2, group-B]\n        E1[Element 1<br/>zIndex: 0<br/>parentId: group-A]\n        E2[Element 2<br/>zIndex: 1<br/>parentId: group-A]\n        G2[Group B<br/>zIndex: 2<br/>parentId: group-A<br/>childIds: element-3]\n        E3[Element 3<br/>zIndex: 0<br/>parentId: group-B]\n        R2[Root Element 2<br/>zIndex: 2<br/>parentId: null]\n    end\n    \n    subgraph "Hierarchy View"\n        direction TB\n        Root[Canvas Root]\n        Root --\x3e RE1[Root Element 1]\n        Root --\x3e GA[Group A]\n        Root --\x3e RE2[Root Element 2]\n        GA --\x3e EL1[Element 1]\n        GA --\x3e EL2[Element 2]\n        GA --\x3e GB[Group B nested]\n        GB --\x3e EL3[Element 3]\n    end\n    \n    R1 -.->|renders as| RE1\n    G1 -.->|organizes| GA\n    E1 -.->|child of| EL1\n    E2 -.->|child of| EL2\n    G2 -.->|nested in| GB\n    E3 -.->|grandchild via| EL3\n    R2 -.->|renders as| RE2\n    \n    style G1 fill:#2196f3\n    style G2 fill:#2196f3\n    style GA fill:#2196f3\n    style GB fill:#2196f3'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Data structure:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface GroupElement extends CanvasElementBase {\n  type: 'group';\n  data: GroupData;\n}\n\ninterface GroupData {\n  childIds: string[];           // Ordered list of child element IDs\n  name: string;                 // Display name for the group\n  isLocked: boolean;            // Lock state (cascades to children)\n  isHidden: boolean;            // Visibility state (cascades to children)\n  isExpanded: boolean;          // UI: whether group is expanded in panel\n  transform: {                  // Group-level transformation\n    translateX: number;\n    translateY: number;\n    rotation: number;\n    scaleX: number;\n    scaleY: number;\n  };\n}\n\ninterface PathElement extends CanvasElementBase {\n  type: 'path';\n  parentId?: string | null;     // Reference to parent group (if any)\n  data: PathData;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"group-operations",children:"Group Operations"}),"\n",(0,s.jsx)(n.h3,{id:"create-group-from-selection",children:"Create Group from Selection"}),"\n",(0,s.jsx)(n.p,{children:"Creates a new group containing the currently selected elements. The operation:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Validates selection (at least 2 elements)"}),"\n",(0,s.jsx)(n.li,{children:"Filters out elements with selected ancestors (avoid duplicate nesting)"}),"\n",(0,s.jsx)(n.li,{children:"Determines common parent (if all selected elements share one)"}),"\n",(0,s.jsxs)(n.li,{children:["Creates group element with ordered ",(0,s.jsx)(n.code,{children:"childIds"})]}),"\n",(0,s.jsxs)(n.li,{children:["Updates child elements to set ",(0,s.jsx)(n.code,{children:"parentId"})," to new group ID"]}),"\n",(0,s.jsx)(n.li,{children:"If children had a parent, replaces child references in parent with group reference"}),"\n",(0,s.jsx)(n.li,{children:"Normalizes Z-indices to maintain rendering order"}),"\n",(0,s.jsx)(n.li,{children:"Selects the newly created group"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Algorithm:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'1. selectedElements = filter(elements where id in selectedIds)\n2. normalizedSelection = filter(selectedElements without selected ancestors)\n3. if normalizedSelection.length < 2: abort\n\n4. parentId = commonParent(normalizedSelection) or null\n5. orderedChildIds = sort(normalizedSelection by zIndex or parent\'s childIds order)\n\n6. groupId = generateUniqueId()\n7. groupName = customName or "Group N"\n\n8. for each child in orderedChildIds:\n     child.parentId = groupId\n\n9. if parentId exists:\n     parent.childIds = replace(child IDs with groupId at insertion point)\n\n10. create GroupElement with:\n      - id: groupId\n      - parentId: parentId\n      - data.childIds: orderedChildIds\n      - data.name: groupName\n      - zIndex: min(child zIndices)\n\n11. normalize root Z-indices\n12. select groupId\n'})}),"\n",(0,s.jsx)(n.h3,{id:"ungroup-selected-groups",children:"Ungroup Selected Groups"}),"\n",(0,s.jsx)(n.p,{children:"Dissolves selected groups, restoring children to the group's parent (or root level if no parent). The operation:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Filters selected elements to only groups"}),"\n",(0,s.jsxs)(n.li,{children:["For each group:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Sets children's ",(0,s.jsx)(n.code,{children:"parentId"})," to group's ",(0,s.jsx)(n.code,{children:"parentId"})," (or null)"]}),"\n",(0,s.jsxs)(n.li,{children:["If group had a parent, replaces group ID in parent's ",(0,s.jsx)(n.code,{children:"childIds"})," with group's children"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Removes group elements from canvas"}),"\n",(0,s.jsx)(n.li,{children:"Normalizes Z-indices"}),"\n",(0,s.jsx)(n.li,{children:"Selects the released children"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Algorithm:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. groupsToUngroup = filter(selectedElements where type === 'group')\n2. if groupsToUngroup.length === 0: abort\n\n3. releasedChildIds = []\n4. for each group in groupsToUngroup:\n     parentId = group.parentId or null\n     \n     for each childId in group.childIds:\n       child.parentId = parentId\n       releasedChildIds.push(childId)\n     \n     if parentId exists:\n       parent.childIds = replace(group.id with group.childIds)\n     \n     remove group from elements\n\n5. normalize root Z-indices\n6. select releasedChildIds\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rename-group",children:"Rename Group"}),"\n",(0,s.jsx)(n.p,{children:"Updates a group's display name, used in the selection panel and exports."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.renameGroup(groupId: string, name: string)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validation:"})," Trims whitespace, rejects empty names."]}),"\n",(0,s.jsx)(n.h3,{id:"toggle-group-expansion",children:"Toggle Group Expansion"}),"\n",(0,s.jsx)(n.p,{children:"Controls whether a group's children are visible in the selection panel (UI-only state, doesn't affect rendering)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.setGroupExpanded(groupId: string, expanded: boolean)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Only affects UI panel display, not canvas rendering."]}),"\n",(0,s.jsx)(n.h3,{id:"toggle-group-visibilitylock",children:"Toggle Group Visibility/Lock"}),"\n",(0,s.jsxs)(n.p,{children:["Toggles the ",(0,s.jsx)(n.code,{children:"isHidden"})," or ",(0,s.jsx)(n.code,{children:"isLocked"})," state of a group, which ",(0,s.jsx)(n.strong,{children:"cascades to all descendants"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.toggleGroupVisibility(groupId: string)\nstate.toggleGroupLock(groupId: string)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Cascade behavior:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hidden"}),": Group and all descendants become non-interactive and visually dimmed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Locked"}),": Group and all descendants cannot be selected or modified"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Propagation"}),": States propagate through nested groups recursively"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"group-flow-diagram",children:"Group Flow Diagram"}),"\n",(0,s.jsx)(n.mermaid,{value:"flowchart TD\n    Start([User Action]) --\x3e CheckAction{What action?}\n    \n    CheckAction --\x3e|Create Group| ValidateSelection{2+ elements<br/>selected?}\n    CheckAction --\x3e|Ungroup| ValidateGroups{Selected elements<br/>are groups?}\n    CheckAction --\x3e|Rename| UpdateName[Update group.data.name]\n    CheckAction --\x3e|Toggle Expand| UpdateExpanded[Update group.data.isExpanded]\n    CheckAction --\x3e|Toggle Visibility| CascadeHidden[Set group + descendants<br/>isHidden state]\n    CheckAction --\x3e|Toggle Lock| CascadeLocked[Set group + descendants<br/>isLocked state]\n    \n    ValidateSelection --\x3e|No| Error1[Show error/<br/>disable button]\n    ValidateSelection --\x3e|Yes| FilterAncestors[Filter out elements<br/>with selected ancestors]\n    \n    FilterAncestors --\x3e DetermineParent[Determine common<br/>parent if any]\n    DetermineParent --\x3e OrderChildren[Order children by<br/>parent's childIds or zIndex]\n    OrderChildren --\x3e CreateGroupElement[Create GroupElement<br/>with childIds]\n    \n    CreateGroupElement --\x3e UpdateChildren[Set children's<br/>parentId to groupId]\n    UpdateChildren --\x3e UpdateParent{Group has<br/>parent?}\n    UpdateParent --\x3e|Yes| ReplaceInParent[Replace child IDs<br/>with groupId in parent]\n    UpdateParent --\x3e|No| AddToRoot[Add to root level]\n    \n    ReplaceInParent --\x3e Normalize1[Normalize root Z-indices]\n    AddToRoot --\x3e Normalize1\n    Normalize1 --\x3e SelectGroup[Select new group]\n    SelectGroup --\x3e End1([Group created])\n    \n    ValidateGroups --\x3e|No| Error2[Abort: not groups]\n    ValidateGroups --\x3e|Yes| IterateGroups[For each group]\n    \n    IterateGroups --\x3e ReleaseChildren[Set children's parentId<br/>to group's parentId]\n    ReleaseChildren --\x3e UpdateGroupParent{Group has<br/>parent?}\n    UpdateGroupParent --\x3e|Yes| ReplaceGroupInParent[Replace groupId<br/>with childIds in parent]\n    UpdateGroupParent --\x3e|No| PromoteToRoot[Promote children to root]\n    \n    ReplaceGroupInParent --\x3e RemoveGroup[Remove group element]\n    PromoteToRoot --\x3e RemoveGroup\n    RemoveGroup --\x3e Normalize2[Normalize root Z-indices]\n    Normalize2 --\x3e SelectChildren[Select released children]\n    SelectChildren --\x3e End2([Group ungrouped])\n    \n    UpdateName --\x3e End3([Name updated])\n    UpdateExpanded --\x3e End3\n    CascadeHidden --\x3e CollectDescendants[Recursively collect<br/>all descendant IDs]\n    CollectDescendants --\x3e UpdateHiddenIds[Update hiddenElementIds<br/>array in store]\n    UpdateHiddenIds --\x3e End4([Visibility toggled])\n    \n    CascadeLocked --\x3e CollectDescendants2[Recursively collect<br/>all descendant IDs]\n    CollectDescendants2 --\x3e UpdateLockedIds[Update lockedElementIds<br/>array in store]\n    UpdateLockedIds --\x3e End5([Lock toggled])\n    \n    Error1 --\x3e EndError([Operation aborted])\n    Error2 --\x3e EndError"}),"\n",(0,s.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsx)(n.h3,{id:"create-and-ungroup",children:"Create and Ungroup"}),"\n",(0,s.jsx)(n.h4,{id:"creategroupfromselectionname-string-string--null",children:(0,s.jsx)(n.code,{children:"createGroupFromSelection(name?: string): string | null"})}),"\n",(0,s.jsx)(n.p,{children:"Creates a group from selected elements."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const state = useCanvasStore.getState();\n\n// Create group with auto-generated name\nconst groupId = state.createGroupFromSelection();\n\n// Create group with custom name\nconst groupId = state.createGroupFromSelection('Navigation Menu');\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),' (optional): Custom name for the group. If omitted, auto-generates "Group N"']}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," Group ID if successful, ",(0,s.jsx)(n.code,{children:"null"})," if operation fails"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"At least 2 elements must be selected"}),"\n",(0,s.jsx)(n.li,{children:"Selected elements must not all be descendants of other selected elements"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ungroupselectedgroups-void",children:(0,s.jsx)(n.code,{children:"ungroupSelectedGroups(): void"})}),"\n",(0,s.jsx)(n.p,{children:"Ungroups all selected group elements."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const state = useCanvasStore.getState();\n\n// Select groups and ungroup them\nstate.selectElement('group-1');\nstate.addToSelection('group-2');\nstate.ungroupSelectedGroups();\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only affects selected elements that are groups"}),"\n",(0,s.jsx)(n.li,{children:"Released children are automatically selected"}),"\n",(0,s.jsx)(n.li,{children:"Preserves original Z-index order"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ungroupgroupbyidgroupid-string-void",children:(0,s.jsx)(n.code,{children:"ungroupGroupById(groupId: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Ungroups a specific group by ID."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.ungroupGroupById('group-123');\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use case:"})," Ungroup a specific group without changing selection."]}),"\n",(0,s.jsx)(n.h3,{id:"group-properties",children:"Group Properties"}),"\n",(0,s.jsx)(n.h4,{id:"renamegroupgroupid-string-name-string-void",children:(0,s.jsx)(n.code,{children:"renameGroup(groupId: string, name: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Renames a group."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.renameGroup('group-123', 'Header Components');\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validation:"})," Name is trimmed; empty names are rejected."]}),"\n",(0,s.jsx)(n.h4,{id:"setgroupexpandedgroupid-string-expanded-boolean-void",children:(0,s.jsx)(n.code,{children:"setGroupExpanded(groupId: string, expanded: boolean): void"})}),"\n",(0,s.jsx)(n.p,{children:"Sets whether a group is expanded in the selection panel."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Collapse group in UI\nstate.setGroupExpanded('group-123', false);\n\n// Expand group in UI\nstate.setGroupExpanded('group-123', true);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Only affects UI display, not canvas rendering."]}),"\n",(0,s.jsx)(n.h3,{id:"group-state-management",children:"Group State Management"}),"\n",(0,s.jsx)(n.h4,{id:"togglegroupvisibilitygroupid-string-void",children:(0,s.jsx)(n.code,{children:"toggleGroupVisibility(groupId: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Toggles visibility state for group and all descendants."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.toggleGroupVisibility('group-123');\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Effect:"})," Hides/shows group and all nested children."]}),"\n",(0,s.jsx)(n.h4,{id:"togglegrouplockgroupid-string-void",children:(0,s.jsx)(n.code,{children:"toggleGroupLock(groupId: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Toggles lock state for group and all descendants."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.toggleGroupLock('group-123');\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Effect:"})," Locks/unlocks group and all nested children."]}),"\n",(0,s.jsx)(n.h4,{id:"toggleelementvisibilityelementid-string-void",children:(0,s.jsx)(n.code,{children:"toggleElementVisibility(elementId: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Toggles visibility state for a specific element (path or group)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.toggleElementVisibility('element-123');\n"})}),"\n",(0,s.jsx)(n.h4,{id:"toggleelementlockelementid-string-void",children:(0,s.jsx)(n.code,{children:"toggleElementLock(elementId: string): void"})}),"\n",(0,s.jsx)(n.p,{children:"Toggles lock state for a specific element (path or group)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"state.toggleElementLock('element-123');\n"})}),"\n",(0,s.jsx)(n.h3,{id:"query-methods",children:"Query Methods"}),"\n",(0,s.jsx)(n.h4,{id:"getgroupbyidgroupid-string-groupelement--null",children:(0,s.jsx)(n.code,{children:"getGroupById(groupId: string): GroupElement | null"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves a group element by ID."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const group = state.getGroupById('group-123');\nif (group) {\n  console.log(`Group \"${group.data.name}\" has ${group.data.childIds.length} children`);\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"getgroupdescendantsgroupid-string-string",children:(0,s.jsx)(n.code,{children:"getGroupDescendants(groupId: string): string[]"})}),"\n",(0,s.jsx)(n.p,{children:"Gets all descendant element IDs recursively (children, grandchildren, etc.)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const descendants = state.getGroupDescendants('group-123');\nconsole.log(`Group has ${descendants.length} total descendants`);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," Flat array of all descendant IDs in depth-first order."]}),"\n",(0,s.jsx)(n.h4,{id:"iselementhiddenelementid-string-boolean",children:(0,s.jsx)(n.code,{children:"isElementHidden(elementId: string): boolean"})}),"\n",(0,s.jsx)(n.p,{children:"Checks if an element is hidden (directly or via ancestor)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"if (state.isElementHidden('element-123')) {\n  console.log('Element is hidden');\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"iselementlockedelementid-string-boolean",children:(0,s.jsx)(n.code,{children:"isElementLocked(elementId: string): boolean"})}),"\n",(0,s.jsx)(n.p,{children:"Checks if an element is locked (directly or via ancestor)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"if (state.isElementLocked('element-123')) {\n  console.log('Element is locked');\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(n.h3,{id:"basic-grouping",children:"Basic Grouping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Select multiple elements\nstate.selectElement('rect-1');\nstate.addToSelection('rect-2');\nstate.addToSelection('circle-1');\n\n// Create group\nconst groupId = state.createGroupFromSelection('Shapes Group');\n\n// Group is now selected\nconsole.log(state.selectedIds); // ['group-123']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"nested-groups",children:"Nested Groups"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create first group\nstate.selectElements(['element-1', 'element-2']);\nconst innerGroupId = state.createGroupFromSelection('Inner Group');\n\n// Create second group\nstate.selectElements(['element-3', 'element-4']);\nconst outerGroupId = state.createGroupFromSelection('Outer Group');\n\n// Group the groups\nstate.selectElements([innerGroupId, outerGroupId, 'element-5']);\nconst parentGroupId = state.createGroupFromSelection('Parent Group');\n\n// parentGroupId now contains two groups and one element\nconst parent = state.getGroupById(parentGroupId);\nconsole.log(parent.data.childIds); // [innerGroupId, outerGroupId, 'element-5']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"manage-group-state",children:"Manage Group State"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const groupId = 'group-123';\n\n// Hide entire group and descendants\nstate.toggleGroupVisibility(groupId);\n\n// Lock group to prevent edits\nstate.toggleGroupLock(groupId);\n\n// Rename group\nstate.renameGroup(groupId, 'Navigation');\n\n// Collapse in UI panel\nstate.setGroupExpanded(groupId, false);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ungroup-and-select-children",children:"Ungroup and Select Children"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Select and ungroup\nstate.selectElement('group-123');\nstate.ungroupSelectedGroups();\n\n// Children are now selected\nconsole.log(state.selectedIds); // ['child-1', 'child-2', 'child-3']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"query-descendants",children:"Query Descendants"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const groupId = 'parent-group';\nconst descendants = state.getGroupDescendants(groupId);\n\nconsole.log(`Group has ${descendants.length} descendants`);\n\n// Check if specific element is a descendant\nconst isDescendant = descendants.includes('element-456');\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ui-integration",children:"UI Integration"}),"\n",(0,s.jsxs)(n.p,{children:["Groups are managed through the ",(0,s.jsx)(n.strong,{children:"Select Panel"})," in the sidebar:"]}),"\n",(0,s.jsx)(n.h3,{id:"group-item-features",children:"Group Item Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Name display"}),": Editable name with truncation for long names"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Child count badge"}),": Shows number of direct children"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Expand/collapse"}),": Toggle to show/hide children"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Visibility control"}),": Eye icon to hide/show group and descendants"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lock control"}),": Lock icon to lock/unlock group and descendants"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ungroup button"}),": Dissolves group and releases children"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Selection"}),": Click to select group"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"visual-hierarchy",children:"Visual Hierarchy"}),"\n",(0,s.jsx)(n.p,{children:"Groups are rendered with:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Indentation"}),": Visual nesting via left margin"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Chevron icon"}),": Expand/collapse indicator"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Distinct styling"}),": Different background color from paths"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cascading state"}),": Visual feedback when group is hidden/locked"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"group-transforms",children:"Group Transforms"}),"\n",(0,s.jsx)(n.p,{children:"Groups support collective transformations that affect all descendants:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface GroupTransform {\n  translateX: number;    // Horizontal offset\n  translateY: number;    // Vertical offset\n  rotation: number;      // Rotation in degrees\n  scaleX: number;        // Horizontal scale (1 = 100%)\n  scaleY: number;        // Vertical scale (1 = 100%)\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Transform application:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Group transforms are ",(0,s.jsx)(n.strong,{children:"cumulative"})," with child transforms"]}),"\n",(0,s.jsx)(n.li,{children:"Nested groups accumulate transforms from all ancestors"}),"\n",(0,s.jsxs)(n.li,{children:["Moving a group updates its ",(0,s.jsx)(n.code,{children:"transform.translateX/Y"})]}),"\n",(0,s.jsx)(n.li,{children:"Individual child transforms are preserved"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Group transform: { translateX: 100, translateY: 50, rotation: 0, scaleX: 1, scaleY: 1 }\nChild path at (20, 30)\n\u2192 Rendered at (120, 80) = (20 + 100, 30 + 50)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"for-users",children:"For Users"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Name groups meaningfully"}),": Use descriptive names for easy identification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Group by function"}),": Organize related elements (header, footer, nav, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Limit nesting depth"}),": Avoid deeply nested hierarchies (3-4 levels max)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Collapse unused groups"}),": Keep panel clean by collapsing inactive groups"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lock completed sections"}),": Prevent accidental edits to finished work"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use visibility to focus"}),": Hide groups temporarily to focus on specific areas"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"for-plugin-developers",children:"For Plugin Developers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Respect hierarchy"}),": Always check ",(0,s.jsx)(n.code,{children:"parentId"})," when operating on elements"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Handle cascading state"}),": Check ",(0,s.jsx)(n.code,{children:"isElementHidden"}),"/",(0,s.jsx)(n.code,{children:"isElementLocked"})," for descendants"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Maintain order"}),": Preserve ",(0,s.jsx)(n.code,{children:"childIds"})," order when modifying groups"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate ancestors"}),": Prevent creating groups with selected ancestors"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Update references"}),": When deleting groups, properly reparent children"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Normalize Z-indices"}),": Call normalization after operations that affect root elements"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,s.jsx)(n.h3,{id:"organize-ui-components",children:"Organize UI Components"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Group header elements\nconst headerElements = ['logo', 'nav-menu', 'search-box'];\nstate.selectElements(headerElements);\nconst headerId = state.createGroupFromSelection('Header');\n\n// Group footer elements\nconst footerElements = ['copyright', 'social-links', 'contact'];\nstate.selectElements(footerElements);\nconst footerId = state.createGroupFromSelection('Footer');\n\n// Lock completed sections\nstate.toggleGroupLock(headerId);\nstate.toggleGroupLock(footerId);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"create-reusable-component",children:"Create Reusable Component"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create icon with background\nconst iconElements = ['icon-shape', 'background-circle'];\nstate.selectElements(iconElements);\nconst iconGroupId = state.createGroupFromSelection('Icon Component');\n\n// Duplicate group for reuse\n// (duplication would copy the group and all children)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"hierarchical-layer-management",children:"Hierarchical Layer Management"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create nested structure: Scene > Background/Foreground > Elements\nstate.selectElements(['sky', 'mountains']);\nconst bgId = state.createGroupFromSelection('Background');\n\nstate.selectElements(['character', 'props']);\nconst fgId = state.createGroupFromSelection('Foreground');\n\nstate.selectElements([bgId, fgId]);\nconst sceneId = state.createGroupFromSelection('Scene 1');\n\n// Collapse entire scene to declutter panel\nstate.setGroupExpanded(sceneId, false);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"batch-visibility-control",children:"Batch Visibility Control"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Hide all construction guides at once\nconst guidesId = 'guides-group';\nstate.toggleGroupVisibility(guidesId);\n\n// Later, show them again\nstate.toggleGroupVisibility(guidesId);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,s.jsxs)(n.p,{children:["Groups are covered by E2E tests in ",(0,s.jsx)(n.code,{children:"tests/grouping.spec.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"test('creates a group from multiple selected paths', async ({ page }) => {\n  // Create two rectangles\n  const firstId = createRectangle(12, 14);\n  const secondId = createRectangle(80, 20);\n  \n  // Select and group\n  storeApi.getState().selectElements([firstId, secondId]);\n  const groupId = storeApi.getState().createGroupFromSelection('Test Group');\n  \n  // Verify group was created\n  expect(groupId).toBeTruthy();\n  \n  // Verify group is selected\n  expect(selectedIds).toEqual([groupId]);\n  \n  // Verify children have correct parentId\n  childParents.forEach(({ parentId }) => {\n    expect(parentId).toBe(groupId);\n  });\n});\n\ntest('propagates visibility and lock state from group to descendants', async ({ page }) => {\n  // Create group\n  const groupId = createGroupFromSelection('Visibility Group');\n  \n  // Toggle group visibility\n  toggleGroupVisibility(groupId);\n  \n  // Verify descendants are hidden\n  const hiddenAfterToggle = isElementHidden(descendantId);\n  expect(hiddenAfterToggle).toBe(true);\n  \n  // Toggle group lock\n  toggleGroupLock(groupId);\n  \n  // Verify descendants are locked\n  const lockedAfterToggle = isElementLocked(descendantId);\n  expect(lockedAfterToggle).toBe(true);\n});\n\ntest('ungroups selected group and restores child parent references', async ({ page }) => {\n  // Create and select group\n  const groupId = createGroupFromSelection('Ungroup Group');\n  selectElements([groupId]);\n  \n  // Ungroup\n  ungroupSelectedGroups();\n  \n  // Verify group no longer exists\n  expect(hasGroup).toBe(false);\n  \n  // Verify children have null parentId\n  childParents.forEach(({ parentId }) => {\n    expect(parentId === null || parentId === undefined).toBe(true);\n  });\n  \n  // Verify children are selected\n  expect(new Set(selection)).toEqual(new Set(childParents.map(info => info.id)));\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/ttpe/docs/docs/features/selection",children:"Selection System"})," - Element and group selection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/ttpe/docs/docs/features/ordering",children:"Ordering"})," - Z-index management (groups use root-level Z-index)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/ttpe/docs/docs/ui/components",children:"UI Components"})," - UI for group management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/ttpe/docs/docs/features/transforms",children:"Transform System"})," - Group transforms and child propagation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../api/canvas-store",children:"Canvas Store API"})," - Group slice methods"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var t=r(6540);const s={},o=t.createContext(s);function i(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);